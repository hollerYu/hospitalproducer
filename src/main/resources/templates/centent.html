<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script th:src="@{~/common/myJs.jsp}"></script>
</head>
<body>
<table id="tableId"></table>

<!-- 模态框（Modal） --><!--aria-hidden="true"保持模态框 没有事件触发不会显示 -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"
                        aria-hidden="true">×
                </button>
                <h4 class="modal-title" id="myModalLabel">
                    模态框（Modal）标题
                </h4>
            </div>
            <div class="modal-body">
                按下 ESC 按钮退出。
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default"
                        data-dismiss="modal">关闭
                </button>
                <button type="button" class="btn btn-primary">
                    提交更改
                </button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<script type="application/javascript">
    $(function(){

        initDategrid();

        $('#myModal').modal('hide');  //关闭模态框
    })

    function initDategrid(){
        $('#tableId').bootstrapTable({
            toolbar:'#toolbar',
            url:"/contentYjm/selectContent",
            pagination:true, //是否展示分页
            pageList:[1,3,5,10,50],//分页组件
            pageNumber:1,
            pageSize:5,//默认每页条数
            //search:true,//是否显示搜索框
            //searchText:'试试',//初始化搜索文字
            showColumns:false,//是否显示 内容列下拉框
            showToggle:false,//是否显示 切换试图（table/card）按钮
            showPaginationSwitch:false,//是否显示 数据条数选择框
            showRefresh:false,//是否显示刷新按钮
            detailView:false,//设置为 true 可以显示详细页面模式。
            showFooter:false,//是否显示列脚
            clickToSelect: false, //是否启用点击选中行
            sidePagination:'server',//分页方式：client客户端分页，server服务端分页（*
            // striped:true,
            queryParams:function(){
                //	var discuName = $('#discuName').val();
                //	var startTime = $('#startTime').val();
                //	var endTime = $('#endTime').val();
                return{
                    page: this.pageNumber,
                    rows: this.pageSize,
                    //discuName:discuName,
                    //startTime:startTime,
                    //endTime:endTime
                };
            },
            columns:[

                {field:'aaa',title:'xxx',width:60,align:'center',checkbox:true},
                {field:'yhTx',title:'用户头像',width:60,align:'center',},
                {field:'titles',title:'标题',width:200,align:'center',},
                {field:'userContent',title:'评论内容',width:150,align:'center',editor:'text'},
                {field:'praseCount',title:'点赞数',width:100,align:'center',editor:'text'},
                {field:'state',title:'状态',width:100,align:'center',editor:'text',
                    formatter: function(value,row,index){
                       if(value==0){
                           return "待审核";
                       }if(value==1){
                           return "审核通过";
                       }if(value==2){
                           return "审核不通过";
                       }
                    }
                },

                {field:'createTime',title:'评论时间',width:100,align:'center',

                    formatter: function(value,row,index){
                        var mydate = new Date(value)//格式化日期
                        var str = mydate.toLocaleDateString()//日期对象的方法
                        return str;
                    }
                },
                {field:'xxx',title:'操作',width:240,align:'center',

                    formatter: function(value,row,index){
                        var butt=""
                       if(row.state==0){
                            butt += "<input type='button' value='审核通过' class='btn btn-success' onclick='changeState(1,"+row.id+")' >   ";
                            butt += "<input type='button' value='审核不通过' class='btn btn-danger' onclick='changeState(2,"+row.id+")' > ";
                       }
                       if(row.state==1){ //状态为 1  通过
                           butt += "<input type='button'class='btn btn-danger' value='审核不通过' onclick='changeState(2,"+row.id+")'>  ";

                       } if(row.state==2){ //状态为 2  不通过
                           butt += "<input type='button'class='btn btn-success' value='审核通过' onclick='changeState(1,"+row.id+")'>  ";
                       }
                       butt +="<input type='button' class='btn btn-info' value='回复' onclick='replyComment()'>";
                        return butt;
                    },
                },
            ],
        })
    }
    //审核
    function changeState(state,id){
        $.ajax({
            url:'/contentYjm/changeState',
            data:{state:state,id:id},

            success:function(result){

                if(result){
                    layer.msg("执行成功!!!")
                    searcher();
                }else{
                    layer.msg("有异常!!!")
                    searcher();
                }

            },error:function(){

                layer.msg("出错了,请查看控制台!!!!")
            }
        })
    }

    //刷新
    function searcher(){

        $('#tableId').bootstrapTable('refresh');
    }

</script>
</body>
</html>